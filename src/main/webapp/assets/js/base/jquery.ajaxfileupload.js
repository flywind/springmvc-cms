jQuery.extend({createUploadIframe:function(e,t){var r="jUploadFrame"+e,o='<iframe id="'+r+'" name="'+r+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&("boolean"==typeof t?o+=' src="javascript:false"':"string"==typeof t&&(o+=' src="'+t+'"')),o+=" />",jQuery(o).appendTo(document.body),jQuery("#"+r).get(0)},createUploadForm:function(e,t,r){var o="jUploadForm"+e,n="jUploadFile"+e,a=jQuery('<form  action="" method="POST" name="'+o+'" id="'+o+'" enctype="multipart/form-data"></form>');if(r)for(var u in r){var temp=jQuery('<input type="hidden" name="'+u+'" />');temp.val(r[u]);temp.appendTo(a);} "string"==typeof t&&(t=[t]);for(var u=0,d=t.length;d>u;u++){var c=jQuery("#"+t[u]),i=jQuery(c).clone();jQuery(c).attr("id",n),jQuery(c).before(i),jQuery(c).appendTo(a)}return jQuery(a).css("position","absolute"),jQuery(a).css("top","-1200px"),jQuery(a).css("left","-1200px"),jQuery(a).appendTo("body"),a},ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime(),r=jQuery.createUploadForm(t,e.fileElementId,"undefined"==typeof e.data?!1:e.data),o=(jQuery.createUploadIframe(t,e.secureuri),"jUploadFrame"+t),n="jUploadForm"+t;e.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var a=!1,u={};e.global&&jQuery.event.trigger("ajaxSend",[u,e]);var d=function(t){var n=document.getElementById(o);try{n.contentWindow?(u.responseText=n.contentWindow.document.body?n.contentWindow.document.body.innerHTML:null,u.responseXML=n.contentWindow.document.XMLDocument?n.contentWindow.document.XMLDocument:n.contentWindow.document):n.contentDocument&&(u.responseText=n.contentDocument.document.body?n.contentDocument.document.body.innerHTML:null,u.responseXML=n.contentDocument.document.XMLDocument?n.contentDocument.document.XMLDocument:n.contentDocument.document)}catch(d){jQuery.handleError(e,u,null,d)}if(u||"timeout"==t){a=!0;var c;try{if(c="timeout"!=t?"success":"error","error"!=c){var i=jQuery.uploadHttpData(u,e.dataType);e.success&&e.success(i,c),e.global&&jQuery.event.trigger("ajaxSuccess",[u,e])}else jQuery.handleError(e,u,c)}catch(d){c="error",jQuery.handleError(e,u,c,d)}e.global&&jQuery.event.trigger("ajaxComplete",[u,e]),e.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),e.complete&&e.complete(u,c),jQuery(n).unbind(),setTimeout(function(){try{jQuery(n).remove(),jQuery(r).remove()}catch(t){jQuery.handleError(e,u,null,t)}},100),u=null}};e.timeout>0&&setTimeout(function(){a||d("timeout")},e.timeout);try{var r=jQuery("#"+n);jQuery(r).attr("action",e.url),jQuery(r).attr("method","POST"),jQuery(r).attr("target",o),r.encoding?jQuery(r).attr("encoding","multipart/form-data"):jQuery(r).attr("enctype","multipart/form-data"),jQuery(r).submit()}catch(c){jQuery.handleError(e,u,null,c)}return jQuery("#"+o).load(d),{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;if(data="xml"==type||data?r.responseXML:r.responseText,"script"==type&&jQuery.globalEval(data),"json"==type){data=r.responseText;var start=data.indexOf(">");if(-1!=start){var end=data.indexOf("<",start+1);-1!=end&&(data=data.substring(start+1,end))}eval("data = "+data)}return"html"==type&&jQuery("<div>").html(data).evalScripts(),data},handleError:function(e,t,r,o){e.error?e.error(t,r,o):t.responseText&&window.console&&console.log(t.responseText)}});